(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d66ad92"],{"0ba6":function(e,t,n){"use strict";var a=n("d5eb"),i=n.n(a);i.a},"197c":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"root vFlex"},[n("div",{staticClass:"hFlex",staticStyle:{flex:"1",overflow:"hidden"}},[n("div",{staticClass:"leftMenu vFlex"},[n("GhostButton",{on:{click:function(t){return e.$router.push("/")}}}),n("Menu",{staticClass:"menu",attrs:{"default-active":e.activeMenu,width:"180"},on:{select:e.handleMenuSelect}},[n("MenuItem",{attrs:{index:"page"}},[n("Icon",{staticClass:"el-icon-document-add"}),e._v(" 页面 ")],1),n("MenuItem",{attrs:{index:"component"}},[n("Icon",{staticClass:"el-icon-s-grid"}),e._v(" 组件 ")],1),n("MenuItem",{attrs:{index:"model"}},[n("Icon",{staticClass:"el-icon-coin"}),e._v(" Model ")],1)],1),n("Tooltip",{attrs:{content:"同步模板"}},[n("GhostButton",{staticClass:"button",on:{click:e.syncTemplates}},[n("Icon",{staticClass:"el-icon-refresh"})],1)],1)],1),n("div",{staticClass:"content vFlex"},[n("div",{staticClass:"row title"},[e._v(e._s(e.pageTitle))]),n("div",{staticClass:"row hFlex",staticStyle:{"flex-wrap":"wrap"}},[n("span",{staticClass:"label"},[e._v("请输入名称:")]),n("Input",{staticClass:"input",attrs:{clearable:!0,size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.createFromTemplate(t)}},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("div",{staticStyle:{margin:"0 10px 0 15px","white-space":"nowrap","user-select":"contain"}},[e._v(" 当前模板：【"+e._s(e.selectedTemplateName)+"】 ")]),n("Button",{attrs:{size:"mini"},on:{click:function(t){e.showTemplateDrawer=!0}}},[e._v("切换模板")])],1),n("div",{staticStyle:{"border-top":"1px solid #EEEEEE"}}),n("div",{staticClass:"treeContent"},[n("div",{staticStyle:{overflow:"auto",height:"100%"}},[n("Tree",{ref:"tree",attrs:{"node-key":"id",data:e.treeData,"default-expanded-keys":e.defaultExpandedKeys,"render-content":e.renderTreeContent,"expand-on-click-node":!1,"highlight-current":!0},on:{"current-change":e.handleCurrentChange,"node-expand":e.handleTreeNodeExpand,"node-collapse":e.handleTreeNodeCollapse}})],1),n("div",{staticClass:"treeButtonsGroup hFlex"},[n("Tooltip",{attrs:{content:"显示文件"}},[n("div",{staticClass:"treeIcon",on:{click:function(t){e.showFile=!e.showFile}}},[n("Icon",{staticClass:"el-icon-document",style:{color:e.showFile?"#1199FF":""}})],1)]),n("Tooltip",{attrs:{content:"刷新列表"}},[n("div",{staticClass:"treeIcon",on:{click:e.getFileTree}},[n("Icon",{staticClass:"el-icon-refresh"})],1)])],1)]),e.warnTip?n("div",{staticClass:"warnTip"},[e._v(e._s(e.warnTip))]):e._e(),e.name?n("div",{staticClass:"result"},[n("div",[e._v("生成列表：")]),e._l(e.previewFilenames,(function(t,a){return n("div",{key:a,staticClass:"resultItem"},[e._v(" "+e._s(e.currentNodeKey)+"/"),n("span",{staticClass:"previewFilename"},[e._v(e._s(t))])])}))],2):e._e()])]),n("div",{staticClass:"footer hFlex"},[n("div",{staticStyle:{flex:"1"}}),n("Button",{attrs:{type:"primary",size:"small"},on:{click:e.createFromTemplate}},[e._v("创建")])],1),n("Drawer",{attrs:{"destroy-on-close":"",visible:e.showTemplateDrawer,direction:"ttb",title:"选择模板",size:"80%"},on:{"update:visible":function(t){e.showTemplateDrawer=t}}},[n("TemplatePanel",{attrs:{type:e.activeMenu,defaultValue:e.selectedTemplate},on:{onChange:e.handleTemplateChange}})],1)],1)},i=[],r=(n("99af"),n("4de4"),n("7db0"),n("d81d"),n("45fc"),n("b0c0"),n("2ca0"),n("ade3"));function s(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}n("a4d3"),n("e01a"),n("d28b"),n("a630"),n("e260"),n("d3b7"),n("25f0"),n("3ca3"),n("ddb0");function c(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function l(e){return s(e)||c(e)||o()}var d=n("5530"),u=n("1c1e"),p=function(){return Object(u["a"])("/getFileTree")},f=n("5cc5"),h=(n("caad"),n("8a79"),n("2532"),function(e,t){if("model"===t){if(!e.endsWith("/models"))return!1;if(e.includes("/components/")||e.endsWith("/components"))return!1}else if("component"===t){if(!e.includes("/components/")&&!e.endsWith("/components"))return!1}else if("page"===t){if(!e.includes("/pages/")&&!e.endsWith("/pages"))return!1;if(e.includes("/components/")||e.endsWith("/components"))return!1;if(e.includes("/models/")||e.endsWith("/models"))return!1}return!0}),m=function(e,t){return"page"!==t&&(!e.includes("/components/")&&!e.endsWith("/components")&&(!e.includes("/models/")&&!e.endsWith("/models")&&"/pages"!==e))},v=n("9e0c"),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"templatePanelRoot"},e._l(e.templateList,(function(t,a){return n("div",{key:a,class:["item",{checked:t.code===e.$props.defaultValue}],on:{click:function(n){return e.handleItemClick(t)}}},[n("div",{class:["img"],style:{backgroundImage:"url(/__cbdui/api/image?type="+t.place+"&code="+t.code+"&image="+t.previewImg+"&t="+t.random+")"}}),n("div",{staticClass:"text"},[e._v(e._s(t.name))])])})),0)},y=[],T={props:{defaultValue:String,type:String},mounted:function(){},data:function(){return{}},computed:{templateList:function(){var e=this,t=this.$store.state.newTemplate;return t.templates.filter((function(t){return t.type===e.$props.type}))}},methods:{handleItemClick:function(e){this.$emit("onChange",e.code,e)}}},w=T,b=(n("31e4"),n("2877")),x=Object(b["a"])(w,g,y,!1,null,"eb353098",null),C=x.exports,_={name:"NewTemplate",components:{GhostButton:v["a"],TemplatePanel:C},mounted:function(){window._this=this,this.getFileTree(),this.$store.dispatch("newTemplate/getTemplates")},data:function(){return{warnTip:"",defaultExpandedKeys:[],expandedKeys:[],previewFilenames:[],name:"",fileTree:[],currentNodeKey:"/page",showFile:!1,showTemplateDrawer:!1}},computed:{pageTitle:function(){var e=this.$store.state.newTemplate;return{page:"新建页面",component:"新建组件",model:"新建模板"}[e.activeMenu]},activeMenu:function(){var e=this.$store.state.newTemplate;return e.activeMenu},treeData:function(){var e=this.$store.state.newTemplate,t=e.activeMenu,n=this.showFile,a=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.filter((function(e){return!e.name.startsWith(".")})).filter((function(e){var t=e.type;return n||"file"!==t})).map((function(t){return Object(d["a"])({},t,{id:"".concat(a,"/").concat(t.name),label:t.name,children:e(t.children,"".concat(a,"/").concat(t.name)),disabled:"file"===t.type})}))};return a("page"===t?this.fileTree.filter((function(e){var t=e.name;return"pages"===t})):"component"===t?this.fileTree.filter((function(e){var t=e.name;return"pages"===t||"components"===t})):"model"===t?this.fileTree.filter((function(e){var t=e.name;return"pages"===t||"models"===t})):this.fileTree)},selectedTemplate:function(){var e=this.$store.state,t=e.config,n=e.newTemplate;return"page"===n.activeMenu&&t.templatePage?t.templatePage:"model"===n.activeMenu&&t.templateModel?t.templateModel:"component"===n.activeMenu&&t.templateComponent?t.templateComponent:n.activeMenu},selectedTemplateName:function(){var e=this,t=this.$store.state.newTemplate,n=t.templates,a=t.activeMenu,i=n.find((function(t){return t.code===e.selectedTemplate&&t.type===a}));return i?i.name:"未选择"}},watch:{name:function(){this.previewTemplateFiles(),this.checkTemplatePath()},"$store.state.newTemplate.activeMenu":function(){this.defaultExpandedKeys=this.expandedKeys},fileTree:function(){var e=this.fileTree.filter((function(e){var t=e.type;return"file"!==t})).map((function(e){var t=e.name;return"/".concat(t)}));0===this.expandedKeys.length?(this.defaultExpandedKeys=e,this.expandedKeys=e):this.defaultExpandedKeys=this.expandedKeys},treeData:function(){var e=this;function t(e,n){return e.some((function(e){return e.id===n||t(e.children,n)}))}this.previewTemplateFiles();var n=t(this.treeData,this.currentNodeKey);setTimeout((function(){n||(e.currentNodeKey=e.treeData[0].id),e.$refs.tree.setCurrentKey(e.currentNodeKey)}))}},methods:{mkdir:function(e){var t=this;Object(f["d"])(e).then((function(e){e.success&&(t.getFileTree(),t.handleTreeNodeExpand({id:t.currentNodeKey}))}))},createFromTemplate:function(){var e=this;Object(f["b"])({name:this.name,path:this.currentNodeKey,template:this.selectedTemplate}).then((function(t){t.success&&(e.$message.success("已成功创建".concat(t.data.length,"个文件")),e.name="",e.getFileTree(),e.handleTreeNodeExpand({id:e.currentNodeKey}))}))},checkTemplatePath:function(){var e=this,t=this.$store.state.newTemplate;Object(f["a"])({name:this.name,path:this.currentNodeKey,template:t.activeMenu}).then((function(t){t.success&&(e.warnTip=t.data)}))},getFileTree:function(){var e=this;p().then((function(t){t.success&&(e.fileTree=t.data)}))},syncTemplates:function(){var e=this;Object(f["f"])().then((function(t){if(t.success){var n=t.data.filter((function(e){var t=e.status;return"success"===t}));0===n.length?e.$message.info("已经是最新了"):(e.$message.success("成功同步了模板x".concat(n.length,"【").concat(n.map((function(e){var t=e.name;return t})),"】")),e.$store.dispatch("newTemplate/getTemplates"))}}))},previewTemplateFiles:function(){var e=this,t=this.$store.state.newTemplate;Object(f["e"])({name:this.name,path:this.currentNodeKey,template:t.activeMenu}).then((function(t){t.success&&(e.previewFilenames=t.data)}))},renderTreeContent:function(e,t){var n=this,a=t.node,i=t.data,r=this.$store.state.newTemplate.activeMenu,s=h(i.id,r),c="directory"===i.type&&m(i.id,r),o=a.expanded?e("Icon",{class:"folder-icon el-icon-folder-opened"}):e("Icon",{class:"folder-icon el-icon-folder"});return e("span",{class:"custom-tree-node ".concat(s?"":"tree-item-disabled")},["directory"===i.type?o:e("Icon",{class:"folder-icon el-icon-document"}),e("span",[a.label]),e("div",{style:"flex:1"}),c&&e("div",{class:"treeItemButton",on:{click:function(){return n.mkdir("".concat(i.id,"/").concat(r,"s"))}}},["新建 ",r,"s 目录"])])},handleMenuSelect:function(e){this.$store.commit("newTemplate/update",{activeMenu:e}),this.checkTemplatePath()},handleCurrentChange:function(e){"file"!==e.type?(this.currentNodeKey=e.id,this.checkTemplatePath()):(this.$message({message:"只能选择目录",type:"warning",duration:1e3}),this.$refs.tree.setCurrentKey(this.currentNodeKey))},handleTreeNodeExpand:function(e){this.expandedKeys=[].concat(l(this.defaultExpandedKeys),[e.id])},handleTreeNodeCollapse:function(e){this.expandedKeys=this.defaultExpandedKeys.filter((function(t){return t!==e.id}))},handleTemplateChange:function(e){var t=this,n=this.$store.state.newTemplate,a="";"page"===n.activeMenu&&(a="templatePage"),"model"===n.activeMenu&&(a="templateModel"),"component"===n.activeMenu&&(a="templateComponent"),this.$store.dispatch(Object(r["a"])({type:"setting/setConfig"},a,e)).then((function(){t.showTemplateDrawer=!1}))}}},k=_,M=(n("47c8"),Object(b["a"])(k,a,i,!1,null,"37fd8de4",null));t["default"]=M.exports},2532:function(e,t,n){"use strict";var a=n("23e7"),i=n("5a34"),r=n("1d80"),s=n("ab13");a({target:"String",proto:!0,forced:!s("includes")},{includes:function(e){return!!~String(r(this)).indexOf(i(e),arguments.length>1?arguments[1]:void 0)}})},"2ca0":function(e,t,n){"use strict";var a=n("23e7"),i=n("06cf").f,r=n("50c4"),s=n("5a34"),c=n("1d80"),o=n("ab13"),l=n("c430"),d="".startsWith,u=Math.min,p=o("startsWith"),f=!l&&!p&&!!function(){var e=i(String.prototype,"startsWith");return e&&!e.writable}();a({target:"String",proto:!0,forced:!f&&!p},{startsWith:function(e){var t=String(c(this));s(e);var n=r(u(arguments.length>1?arguments[1]:void 0,t.length)),a=String(e);return d?d.call(t,a,n):t.slice(n,n+a.length)===a}})},"31e4":function(e,t,n){"use strict";var a=n("8eb3"),i=n.n(a);i.a},"44e7":function(e,t,n){var a=n("861d"),i=n("c6b6"),r=n("b622"),s=r("match");e.exports=function(e){var t;return a(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==i(e))}},"45fc":function(e,t,n){"use strict";var a=n("23e7"),i=n("b727").some,r=n("a640"),s=n("ae40"),c=r("some"),o=s("some");a({target:"Array",proto:!0,forced:!c||!o},{some:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"47c8":function(e,t,n){"use strict";var a=n("5cc8"),i=n.n(a);i.a},"4df4":function(e,t,n){"use strict";var a=n("0366"),i=n("7b0b"),r=n("9bdd"),s=n("e95a"),c=n("50c4"),o=n("8418"),l=n("35a1");e.exports=function(e){var t,n,d,u,p,f,h=i(e),m="function"==typeof this?this:Array,v=arguments.length,g=v>1?arguments[1]:void 0,y=void 0!==g,T=l(h),w=0;if(y&&(g=a(g,v>2?arguments[2]:void 0,2)),void 0==T||m==Array&&s(T))for(t=c(h.length),n=new m(t);t>w;w++)f=y?g(h[w],w):h[w],o(n,w,f);else for(u=T.call(h),p=u.next,n=new m;!(d=p.call(u)).done;w++)f=y?r(u,g,[d.value,w],!0):d.value,o(n,w,f);return n.length=w,n}},"5a34":function(e,t,n){var a=n("44e7");e.exports=function(e){if(a(e))throw TypeError("The method doesn't accept regular expressions");return e}},"5cc8":function(e,t,n){},"7db0":function(e,t,n){"use strict";var a=n("23e7"),i=n("b727").find,r=n("44d2"),s=n("ae40"),c="find",o=!0,l=s(c);c in[]&&Array(1)[c]((function(){o=!1})),a({target:"Array",proto:!0,forced:o||!l},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(c)},"8a79":function(e,t,n){"use strict";var a=n("23e7"),i=n("06cf").f,r=n("50c4"),s=n("5a34"),c=n("1d80"),o=n("ab13"),l=n("c430"),d="".endsWith,u=Math.min,p=o("endsWith"),f=!l&&!p&&!!function(){var e=i(String.prototype,"endsWith");return e&&!e.writable}();a({target:"String",proto:!0,forced:!f&&!p},{endsWith:function(e){var t=String(c(this));s(e);var n=arguments.length>1?arguments[1]:void 0,a=r(t.length),i=void 0===n?a:u(r(n),a),o=String(e);return d?d.call(t,o,i):t.slice(i-o.length,i)===o}})},"8eb3":function(e,t,n){},"99af":function(e,t,n){"use strict";var a=n("23e7"),i=n("d039"),r=n("e8b5"),s=n("861d"),c=n("7b0b"),o=n("50c4"),l=n("8418"),d=n("65f0"),u=n("1dde"),p=n("b622"),f=n("2d00"),h=p("isConcatSpreadable"),m=9007199254740991,v="Maximum allowed index exceeded",g=f>=51||!i((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),y=u("concat"),T=function(e){if(!s(e))return!1;var t=e[h];return void 0!==t?!!t:r(e)},w=!g||!y;a({target:"Array",proto:!0,forced:w},{concat:function(e){var t,n,a,i,r,s=c(this),u=d(s,0),p=0;for(t=-1,a=arguments.length;t<a;t++)if(r=-1===t?s:arguments[t],T(r)){if(i=o(r.length),p+i>m)throw TypeError(v);for(n=0;n<i;n++,p++)n in r&&l(u,p,r[n])}else{if(p>=m)throw TypeError(v);l(u,p++,r)}return u.length=p,u}})},"9e0c":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._g(e._b({staticClass:"ghostButton"},"div",e.$attrs,!1),e.$listeners),[e._t("default",[n("Icon",{staticClass:"el-icon-back"})])],2)},i=[],r={},s=r,c=(n("0ba6"),n("2877")),o=Object(c["a"])(s,a,i,!1,null,"16d5e932",null);t["a"]=o.exports},a630:function(e,t,n){var a=n("23e7"),i=n("4df4"),r=n("1c7e"),s=!r((function(e){Array.from(e)}));a({target:"Array",stat:!0,forced:s},{from:i})},ab13:function(e,t,n){var a=n("b622"),i=a("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,"/./"[e](t)}catch(a){}}return!1}},caad:function(e,t,n){"use strict";var a=n("23e7"),i=n("4d64").includes,r=n("44d2"),s=n("ae40"),c=s("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:!c},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r("includes")},d5eb:function(e,t,n){}}]);
//# sourceMappingURL=chunk-4d66ad92.87fb07d0.js.map